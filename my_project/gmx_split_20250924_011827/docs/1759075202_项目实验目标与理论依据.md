# 项目实验目标与理论依据（gmx_split_20250924_011827）

- 作者：GaoZheng
- 日期：2025-09-29

## 实验目标

- 构建一个最小可复现的蛋白-配体快速评分流程，面向候选姿势（poses）的排序与筛选。
- 在既定坐标上使用 `gmx mdrun -rerun` 重算能量，并以能量组对的短程相互作用能作为快速打分指标。
- 产出可审计、可移植的工件：`em.tpr`、`score.edr`、`score_terms.xvg`、`scores.csv` 与完整流程文档。
- 便于将该流程迁移到其他项目或更多体系（通过 `my_project/**/docs` 与脚本接口）。

## 理论依据

- 经典力场能量分解：总势能近似由键、角、二面角等内能与非键相互作用（库伦、范德华）组成；在蛋白-配体体系中，短程库伦与短程 LJ 的配体-蛋白相互作用能对相对稳定性有显著指示意义。
- 能量组（`energygrps`）机制：在预处理阶段（`grompp`）指定 `[ Protein ]` 与 `[ Ligand ]` 分组，后续 `gmx energy` 可直接提取组间相互作用项，如 `Coul-SR:Protein-Ligand` 与 `LJ-SR:Protein-Ligand`。
- `-rerun` 原理：不改变分子构型，仅基于输入坐标重算能量（和/或力）；适合对一批候选构型进行一致的能量评估与排序。
- 打分函数：`score = Coul-SR(Protein–Ligand) + LJ-SR(Protein–Ligand)`，分值越小通常认为越有利于结合（仅为相对指标，不等价于结合自由能）。
- 参数与力场：
  - 配体使用 GAFF2 + AM1-BCC 电荷（由 ACPYPE/Antechamber 生成），蛋白 Amber99SB-ILDN，水 TIP3P。
  - 快速评分示例中使用 1.2 nm 截断（Cut-off），更严谨评估可改用 PME 并与生产设置一致（影响数值的可比性）。

## 实验设计（流程要点）

- 数据准备：`complex.gro`、`topol.top`、`index.ndx`（含 `[ Protein ]`、`[ Ligand ]`），`em.mdp` 指定 `energygrps = Protein Ligand`。
- 配体参数化：`acpype -i hiv.mol2 -b LIG -o gmx` 生成 `LIG_GMX.itp/gro` 并在 `topol.top` 中 `#include`。
- 生成 `tpr`：`gmx grompp -f em.mdp -c complex.gro -p topol.top -o em.tpr`（示例 `em.mdp` 设 `nsteps=0`）。
- rerun 评分：`gmx mdrun -s em.tpr -rerun <candidate>.gro -deffnm score`；再用 `gmx energy` 选择 `Coul-SR:Protein-Ligand` 与 `LJ-SR:Protein-Ligand` 输出 `score_terms.xvg`，取末帧两列求和。
- 批量候选：`my_scripts/dock_minimal.py` 用随机刚体扰动生成多姿势并统一 rerun，产出 `scores.csv`。

## 假设与限制

- 本流程用于“相对排序”而非绝对结合自由能；未考虑溶剂化自由能、熵项、构象重排等效应。
- `Cut-off` 设置下的数值与 PME 下的数值不具可比性；不同 `mdp` 需保持一致以保证横向可比。
- `energygrps` 必须与 `index.ndx` 一致，否则无法正确提取组间项；`[ Ligand ]` 应仅包含小分子配体原子。

## 结果判读与验收标准（建议）

- 判读：以 `score_terms.xvg` 末帧的 `Coul-SR + LJ-SR` 求和作为打分，越小越优；在同一体系、同一参数下比较不同候选的相对大小。
- 验收（单候选）：成功生成 `em.tpr`、`score.edr`、`score_terms.xvg`，并能从 `score_terms.xvg` 正确解析两列能量。
- 验收（多候选）：`scores.csv` 存在且按分值升序；控制台打印 Top-10 摘要。

## 复现环境与版本

- 推荐 GROMACS ≥ 2024.1（示例 `mdout.mdp` 由 2024.1 生成）；脚本兼容 2020+。
- 需安装 AmberTools（Antechamber/Parmchk）与 Open Babel（如需从 SMILES/2D 生成 3D）。
- 脚本入口：`my_scripts/generate_hiv_mol2_wsl.sh`、`my_scripts/dock_minimal.py`。

## 目录与文档维护

- 本项目目录：`my_project/gmx_split_20250924_011827`；文档集中于 `docs/`。
- 文档命名遵循 `my_docs/project_docs` 规则：`<秒级时间戳>_标题.md`，标题下一行添加 `日期：YYYY年MM月DD日`。
- 可使用对齐脚本（`my_scripts/align_my_documents.py`/`.ps1`）进行幂等整理。

---

**许可声明 (License)**

Copyright (C) 2025 GaoZheng

本文档采用[知识共享-署名-非商业性使用-禁止演绎 4.0 国际许可协议 (CC BY-NC-ND 4.0)](https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh-Hans)进行许可。
